<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>问题</title>
    <link rel="stylesheet" type="text/css" href="../../css/global.css">
    <link rel="stylesheet" type="text/css" href="../../css/mobile/question/question.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://lib.baomitu.com/font-awesome/5.11.2/css/all.min.css">
    <script type="text/javascript" src="https://lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://lib.baomitu.com/vue/2.6.10/vue.min.js"></script>
</head>
<body>
<div id="question" v-if="load">
    <div id="header">
        <table style="color: #acacac">
            <td style="width: 80%;padding-left: 1em"><i class="fas fa-chevron-left"></i></td>
            <td style="width: 10%"><i class="fas fa-search"></i></td>
            <td style="width: 10%"><i class="fas fa-ellipsis-h"></i></td>
        </table>
    </div>
    <br>
    <div id="questionInf">
        <table style="color: #12eee7;margin-bottom: 1em">
            <td style="width: 15%">
                <div v-html="headPortrait" class="headPortrait"></div>
            </td>
            <td style="width: 50%"><span>{{owner.username}}</span>的提问</td>
            <td style="width: 35%;text-align: right">
                <span v-if="isSolved"><i class="fas fa-check-circle"></i>&nbsp;问题已解决</span>
                <span v-else style="color: #acacac"><i class="fas fa-times-circle"></i>&nbsp;问题未解决</span>
            </td>
        </table>
        <h5><b>{{title}}</b></h5>
        <h6 v-html="content"></h6>
        <br>
        <table style="font-size: 0.8em;opacity: 0.5">
            <td style="width: 50%">{{collectionCount}}人收藏-{{browsingCount}}次浏览</td>
            <td style="width: 50%;text-align: right">
                <span><i class="fas fa-star"></i>&nbsp;收藏问题</span>
            </td>
        </table>
        <div id="line"></div>
        <table style="font-size: 0.8em">
            <td style="width: 50%"><span style="opacity: 0.6">回答{{answerCount}}</span></td>
            <td style="width: 50%;text-align: right">
                <div class="dropdown">
                    <button class="noBorder dropdown-toggle" type="button" id="sortDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span style="font-size: 0.8em;opacity: 0.6">{{sortMethod}}</span>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="sortDropdown" style="font-size: 0.8em;width: 5em">
                        <button class="noBorder" style="display: block">默认排序</button>
                        <button class="noBorder" style="display: block">按时间排序</button>
                    </div>
                </div>
            </td>
        </table>
    </div>
    <div id="answerList">
        <div class="item" v-for="answer in answers">
            <div class="separator"></div>
            <div class="answer">
                <div class="answererInf">
                    <table>
                        <td style="width: 15%">
                            <div class="headPortrait" v-html="answer.answererHead"></div>
                        </td>
                        <td style="width: 55%">
                            <span class="username">{{answer.answererName}}</span>
                            <span class="identity"></span>
                        </td>
                        <td style="width: 30%;text-align: right">
                            <span class="lb"><b>LV&nbsp;{{answer.answererLevel}}</b></span>
                            <span class="lb">
                                <i class="fas fa-award fa-1x"></i>
                                <b>{{answer.answererBadge}}</b>
                            </span>
                        </td>
                    </table>
                </div>
                <div class="answerInf">
                    <p class="answerView" v-html="answer.answerView"></p>
                    <table>
                        <td style="width: 80%;opacity: 0.5;font-size: 0.8em">
                            {{answer.answerApprove}}赞同-{{answer.answerComment}}评论-{{answer.answerTime}}
                        </td>
                        <td style="width: 20%;text-align: right;">
                            <div class="dropdown">
                                <button class="noBorder" type="button" id="reportDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <i class="fas fa-ellipsis-h" style="opacity: 0.5"></i>
                                </button>
                                <div class="dropdown-menu" aria-labelledby="reportDropdown" style="font-size: 0.8em;width: 5em">
                                    <button class="noBorder" style="display: block">举报</button>
                                </div>
                            </div>
                        </td>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <br><br>
    <div id="footer">
        <button><i class="fas fa-user-plus">邀请回答</i></button>
        <button><i class="fas fa-pen">写回答</i></button>
        <button><i class="fas fa-star">收藏问题</i></button>
    </div>
</div>
<script type="text/javascript">
    let question = new Vue({
        el:"#question",
        data:{
            isAnonymous:1,
            isSolved:1,
            owner:{
                id:1,
                username:"",
                head:"0.jpg",
            },
            title:"",
            content:"",
            collectionCount:0,
            browsingCount:0,
            answerCount:0,
            answers:[],
            sortMethod:"默认排序",
            headFirstPart:"<img src='../../head/",
            headLastPart:"' width='100%' height='100%' alt=''>",
            load:false
        },
        methods:{

        },
        mounted:function () {
            let loc = location.href;
            loc = loc.replace("?","&").split("&")[1];
            let questionId;
            if (loc.indexOf("questionId=")!==-1) {
                questionId = loc.replace("questionId=","");
            } else {
                location.href = "../../error/mobile/404error.html"
            }
            $.ajax({
                url:"../../question/viewQuestion.action",
                type:"GET",
                data:{
                    questionId:questionId
                },
                dataType:"json",
                success:function (result) {
                    if (result.resultCode === 0) {
                        question.isAnonymous = result.isAnonymous;
                        if (question.isAnonymous === 0) {
                            question.owner.id = 0;
                            question.owner.username = "匿名用户";
                            question.owner.head = "0.jpg";
                        } else {
                            question.owner.id = result.owner.id;
                            question.owner.username = result.owner.username;
                            question.owner.head = result.owner.head;
                        }
                        question.title = result.title;
                        question.content = result.content;
                        question.collectionCount = result.collectionCount;
                        question.browsingCount = result.browsingCount;
                        question.answerCount = result.answerCount;
                        question.answers = result.questionAnswers;
                        question.load = true;
                    }
                },
                error:function (e) {
                    alert("哎呀，网页走失了");
                }
            });
        },
        computed:{
            headPortrait:function () {
                return this.headFirstPart + this.owner.head + this.headLastPart;
            }
        }
    });
</script>
</body>
</html>