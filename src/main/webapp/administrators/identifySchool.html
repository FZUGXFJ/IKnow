<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>认证学校管理主页</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/dashboard/">

    <!-- Bootstrap core CSS -->
    <link href="../css/administrators/reportAdmin.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://lib.baomitu.com/font-awesome/5.11.2/css/all.min.css">
    <script type="text/javascript" src="https://lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://lib.baomitu.com/vue/2.6.10/vue.min.js"></script>
    <script type="text/javascript"src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.1/xlsx.full.min.js"></script>
    <script src="https://cdn.bootcss.com/xlsx/0.11.5/xlsx.core.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.1/xlsx.full.min.js"></script>

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <!-- Custom styles for this template -->
    <link href="dashboard.css" rel="stylesheet">
</head>
<body>
<div id="identifySchool">
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" href="#">IKnow</a>
        <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-toggle="collapse" data-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <input class="form-control form-control-dark w-100" type="text" placeholder="搜索" aria-label="Search">
        <ul class="navbar-nav px-5">
            <li class="nav-item text-nowrap">
                <a class="nav-link" href="#">搜索</a>
            </li>
        </ul>
        <ul class="navbar-nav px-3" style="background-color: crimson">
            <li class="nav-item text-nowrap">
                <a class="nav-link" href="#" @click="logout">登出</a>
            </li>
        </ul>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="sidebar-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="#" @click="toReportPage(0)">
                                <span data-feather="book"></span>
                                问题举报
                                <span class="badge badge-pill badge-dark" v-if="questionReport>0">{{questionReport}}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" @click="toReportPage(1)">
                                <span data-feather="feather"></span>
                                回答举报
                                <span class="badge badge-pill badge-dark" v-if="answerReport>0">{{answerReport}}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" @click="toReportPage(2)">
                                <span data-feather="message-circle"></span>
                                评论举报
                                <span class="badge badge-pill badge-dark" v-if="commentReport>0">{{commentReport}}</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" @click="toReportPage(3)">
                                <span data-feather="refresh-cw"></span>
                                回复举报
                                <span class="badge badge-pill badge-dark" v-if="replyReport>0">{{replyReport}}</span>
                            </a>
                        </li>
                    </ul>
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学校认证管理</span>
                        <!--                    <a class="d-flex align-items-center text-muted" href="#" aria-label="Add a new report">-->
                        <!--                        <span data-feather="plus-circle"></span>-->
                        <!--                    </a>-->
                    </h6>
                    <ul class="nav flex-column mb-2">
                        <li class="nav-item">
                            <a class="nav-link active" href="statisticsUserAdmin.html">
                                <span data-feather="check-circle"></span>
                                学校认证管理
                            </a>
                        </li>
                    </ul>
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>相关统计</span>
                        <!--                    <a class="d-flex align-items-center text-muted" href="#" aria-label="Add a new report">-->
                        <!--                        <span data-feather="plus-circle"></span>-->
                        <!--                    </a>-->
                    </h6>
                    <ul class="nav flex-column mb-2">
                        <li class="nav-item">
                            <a class="nav-link" href="statisticsUserAdmin.html">
                                <span data-feather="users"></span>
                                用户统计
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">
                                <span data-feather="book"></span>
                                问题统计
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">认证学校管理</h1>
                    <label class="col-sm-2 control-label"></label>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group mr-2">
                            <button v-if="!schoolPage" type="button" class="btn btn-sm btn-outline-secondary" @click="back()">返回</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" @click="disPlaySchool()">学校总览</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" @click="isUpload=!isUpload">上传</button>
                        </div>
                    </div>
                </div>
                <!--            <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>-->
                <h4 v-if="schoolPage">认证学校管理</h4>
<!--                <h4 v-if="schoolPage">认证学校管理</h4>-->
                <h4 v-if="collegePage">
                    <a href="#" @click="disPlaySchool()">
                        认证学校管理
                    </a>
                    / {{schoolNow}}
                </h4>
                <h4 v-if="majorPage">
                    <a href="#" @click="disPlaySchool()">
                        认证学校管理
                    </a>
                    /
                    <a href="#" @click="disPlayCollege(schoolNowID)">
                        {{schoolNow}}
                    </a>
                    /
                    {{collegeNow}}
                </h4>
                <h4 v-if="studentPage">
                    <a href="#" @click="disPlaySchool()">
                        认证学校管理
                    </a>
                    /
                    <a href="#" @click="disPlayCollege(schoolNowID)">
                        {{schoolNow}}
                    </a>
                    /
                    <a href="#" @click="disPlayMajor(majorNowID)">
                        {{collegeNow}}
                    </a>
                    /{{majorNow}}
                </h4>
<!--                <div class="form-group">-->
<!--                    <label class="col-sm-1 control-label">选择文件..</label>-->
<!--                    <label for="file" class="btn btn-sm btn-outline-secondary" οnclick="$('#file').click()">选择文件</label>-->
<!--                    <input id="file" type="file" οnchange="testImport(this)" accept="*" style="display:none">-->
<!--                    <label class="btn btn-sm btn-outline-secondary">上传</label>-->
<!--                </div>-->
<!--                <div>-->
<!--                    <input type="button" value="Excel导入" οnclick="$('#testImport').click()"/>-->
<!--                    <input id="testImport" style="display: none;" type="file" οnchange="testImport(this)" accept="*"/>-->
<!--                </div>-->
                <div v-show="isUpload">
                    <p class="file-name"></p>
                    <input type="file" class="upload-btn" style="display: none">
                    <span type="text" class="file-input-trigger btn btn-sm btn-outline-secondary">选择文件</span>
                    <span type="text" class="btn btn-sm btn-outline-secondary"  @click="upload()">上传</span>
                </div>

                <div class="table-responsive">
                    <table class="table table-striped table-sm" v-if="schoolPage">
                        <thead align="center">
                        <tr>
                            <th>学校ID</th>
                            <th>学校名称</th>
                            <th>学院数</th>
                            <th>专业数</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody align="center">
                        <tr v-for="(schoolInfo,i) in subArr">
                            <td>{{schoolInfo.schoolID}}</td>
                            <td>{{schoolInfo.schoolName}}</td>
                            <td>{{schoolInfo.collegeNums}}</td>
                            <td>{{schoolInfo.majorNums}}</td>
                            <td>
                                <button @click="now=i+(cur-1)*15;disPlayCollege(schoolInfo.schoolID);schoolNow=schoolInfo.schoolName;schoolNowID=schoolInfo.schoolID" class="btn btn-primary btn-sm" data-toggle="modal">查看</button>&nbsp;&nbsp;&nbsp;&nbsp;
                                <button @click="now=i+(cur-1)*15" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#layer">删除</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table class="table table-striped table-sm" v-if="collegePage">
                        <thead align="center">
                        <tr>
                            <th>学校ID</th>
                            <th>学校名称</th>
                            <th>学院ID</th>
                            <th>学院名称</th>
                            <th>专业数</th>
                            <th>教师数</th>
                            <th>学生数</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody align="center">
                        <tr v-for="(collegeInfo,i) in subArr">
                            <td>{{collegeInfo.schoolID}}</td>
                            <td>{{collegeInfo.schoolName}}</td>
                            <td>{{collegeInfo.collegeID}}</td>
                            <td>{{collegeInfo.collegeName}}</td>
                            <td>{{collegeInfo.majorNums}}</td>
                            <td>{{collegeInfo.teacherNums}}</td>
                            <td>{{collegeInfo.studentNums}}</td>
                            <td>
                                <button @click="now=i+(cur-1)*15;disPlayMajor(collegeInfo.schoolID);collegeNow=collegeInfo.collegeName;collegeNowID=collegeInfo.collegeID" class="btn btn-primary btn-sm" data-toggle="modal">查看</button>&nbsp;&nbsp;&nbsp;&nbsp;
                                <button @click="now=i+(cur-1)*15" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#layer">删除</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table class="table table-striped table-sm" v-if="majorPage">
                        <thead align="center">
                        <tr>
                            <th>学校ID</th>
                            <th>学校名称</th>
                            <th>学院ID</th>
                            <th>学院名称</th>
                            <th>专业ID</th>
                            <th>专业名称</th>
                            <th>学生数</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody align="center">
                        <tr v-for="(majorInfo,i) in subArr">
                            <td>{{majorInfo.schoolID}}</td>
                            <td>{{majorInfo.schoolName}}</td>
                            <td>{{majorInfo.collegeID}}</td>
                            <td>{{majorInfo.collegeName}}</td>
                            <td>{{majorInfo.majorID}}</td>
                            <td>{{majorInfo.majorName}}</td>
                            <td>{{majorInfo.studentNums}}</td>
                            <td>
                                <button @click="now=i+(cur-1)*15;disPlayStudent(majorInfo.schoolID);majorNow=majorInfo.majorName;majorNowID=majorInfo.majorID" class="btn btn-primary btn-sm" data-toggle="modal">查看</button>&nbsp;&nbsp;&nbsp;&nbsp;
                                <button @click="now=i+(cur-1)*15" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#layer">删除</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table class="table table-striped table-sm" v-if="studentPage">
                        <thead align="center">
                        <tr>
                            <th>学号</th>
                            <th>姓名</th>
                            <th>学院ID</th>
                            <th>学院名称</th>
                            <th>专业ID</th>
                            <th>专业名称</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody align="center">
                        <tr v-for="(studentInfo,i) in subArr">
                            <td>{{studentInfo.studentID}}</td>
                            <td>{{studentInfo.studentName}}</td>
                            <td>{{studentInfo.collegeID}}</td>
                            <td>{{studentInfo.collegeName}}</td>
                            <td>{{studentInfo.majorID}}</td>
                            <td>{{studentInfo.majorName}}</td>
                            <td>
                                <button @click="now=i+(cur-1)*15;" class="btn btn-primary btn-sm" data-toggle="modal">查看</button>&nbsp;&nbsp;&nbsp;&nbsp;
                                <button @click="now=i+(cur-1)*15" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#layer">删除</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="page-bar">
                        <ul>
                            <li v-if="cur>1"><a v-on:click="cur=1,pageClick()">首页</a></li>
                            <li v-if="cur==1"><a class="banclick">首页</a></li>
                            <li v-if="cur>1"><a v-on:click="cur--,pageClick()">上一页</a></li>
                            <li v-if="cur==1"><a class="banclick">上一页</a></li>
                            <!--当前页背景色为蓝色-->
                            <li v-for="index in indexs"  v-bind:class="{ 'active': cur == index}">
                                <a v-on:click="btnClick(index)">{{ index }}</a>
                            </li>
                            <li v-if="cur<all"><a v-on:click="cur++,pageClick()">下一页</a></li>
                            <li v-if="cur == all"><a class="banclick">下一页</a></li>
                            <li v-if="cur<all"><a v-on:click="cur=all,pageClick()">尾页</a></li>
                            <li v-if="cur == all"><a class="banclick">尾页</a></li>
                            <li><a>共<i>{{all}}</i>页</a></li>
                        </ul>
                    </div>
                </div>
            </main>
        </div>
        <div role="dialog" class="modal fade bs-example-modal-sm" id="layer">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">{{ '确认删除么？'}} </h4>
                    </div>
                    <div class="modal-body text-right">
                        <button data-dismiss="modal" class="btn btn-primary btn-sm">取消</button>
                        <button data-dismiss="modal" class="btn btn-danger btn-sm" @click="del()">确认</button>
                    </div>
                </div>
            </div>
        </div>
        <!--悬浮窗口-->
        <div id="window" class="window_css" style="background-color: white">
            <div>
                <span style="font-size: 1.2em;font-weight: bold">用户信息</span>
                <a href="javascript:void(0)" onclick="hideWindow()">
                    <i class="fas fa-times" style="font-size: 2em;position:absolute;right: 0"></i>
                </a>
            </div>
            <div class="userInfo">
                <h5>基本信息：</h5>
                <div class="form-row">
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="ID:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <input type="number" readonly class="form-control-plaintext" value="1">
                    </div>
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="用户名:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <input type="password" class="form-control">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="个人介绍:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <input type="text" class="form-control" value="春翔的父亲">
                    </div>
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="性别:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <select id="inputState" class="form-control">
                            <option selected>保密</option>
                            <option>男/option>
                            <option>女/option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="用户身份:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <select class="form-control">
                            <option selected>学生</option>
                            <option>老师</option>
                        </select>
                    </div>
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="用户状态:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <select class="form-control">
                            <option selected>正常</option>
                            <option>停封</option>
                            <option>禁言</option>
                        </select>
                    </div>
                </div>
                <h5>设置账户密码：</h5>
                <div class="form-row">
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="邮箱:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <input type="email" class="form-control" value="1185229277@qq.com">
                    </div>
                    <div class="form-group col-1">
                        <input type="text" readonly class="form-control-plaintext" value="密码:" style="text-align: center;font-weight: bold">
                    </div>
                    <div class="form-group col-4">
                        <input type="text" class="form-control" value="123456">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">保存</button>
                <button type="submit" class="btn btn-danger">删除</button>
            </div>
        </div>
        <!--出现悬浮窗口后,背景变暗-->
        <div id="shadow" class="shadow_css"></div>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
<script>
    /*当点击调用此方法后,将悬浮窗口显示出来,背景变暗*/
    function displayWindow() {
        /*悬浮窗口的显示,需要将display变成block*/
        document.getElementById("window").style.display = "block";
        /*将背景变暗*/
        document.getElementById("shadow").style.display = "block";
    }
    /*当点击调用此方法,将悬浮窗口和背景全部隐藏*/
    function hideWindow() {
        document.getElementById("window").style.display = "none";
        document.getElementById("shadow").style.display = "none";
    }
    $(function() {
        // 点击自定义的span标签触发input标签的点击事件
        $('.file-input-trigger').on('click', function() {
            $('.upload-btn').trigger('click')
        })
        // 文件改变时 将文件名称显示到p元素中
        $('.upload-btn').on('change', function(event) {
            var fileName = '已选文件：' + event.target.files[0].name;
            let index = event.target.files[0].name.lastIndexOf(".");
            let fname = event.target.files[0].name.substr(index+1);
            console.log(fname);
            if(fname!="xlsx")
            {
                alert("请上传xlsx文件");
                return;
            }
            $('.file-name').text(fileName)
            testImport(event.target);
        })
    })
    function testImport(obj) {
        //判断是否为文件
        if (!obj.files) {
            return;
        }
        // var index = layer.load(1, { shade: [0.1,'#fff']});
        var f = obj.files[0];
        var reader = new FileReader();
        reader.onabort = function(e) {
            alert("中断了")
        }
        reader.onerror = function(e) {
            alert("出错了")
        }
        reader.onloadstart = function() {
            //开始
            console.log("onloadstart")
        }
        reader.onloadend = function() {
            //结束
            console.log("onloadend")
        }
        reader.onload = function(e) {
            //$("#testImport").val(null); //清空文件栏
            var data = e.target.result;
            var wb = XLSX.read(data, {
                type: 'binary'		//设置类型,读取二进制
            });
            let index = obj.files[0].name.lastIndexOf(".");
            //读第一个Sheet文件内容
            var items = JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]));
            console.log(items);
            identifySchool.schoolName = obj.files[0].name.substr(0,index);
            identifySchool.studentsInfo = items;

            //读第二个Sheet文件内容
            var itemTwo = JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[1]]));
            console.log(itemTwo);
            itemTwo = JSON.parse(itemTwo);
            // layer.closeAll();
        }
        reader.readAsBinaryString(f);
    }

    let identifySchool=new Vue({
        el:"#identifySchool",
        data:{
            schoolInfoList:[],
            collegeInfoList:[],
            majorInfoList:[],
            studentInfoList:[],
            pageInfoList:[],
            schoolName:"",
            studentsInfo:"",
            isRmb:false,
            accountNumError:false,
            accountNumErrorMsg:"",
            passwordError:false,
            passwordErrorMsg:"",
            alertMsg:{head:"",body:""},
            all: 1, //总页数
            cur: 1,//当前页码
            now:-1,//当前索引
            isUpload:false,
            questionReport:0,
            answerReport:0,
            commentReport:0,
            replyReport:0,
            schoolPage:true,
            collegePage:false,
            majorPage:false,
            studentPage:false,
            schoolNow:"",
            collegeNow:"",
            majorNow:"",
            studentNow:"",
            schoolNowID:"",
            collegeNowID:"",
            majorNowID:"",
            studentNowID:""
        },
        watch: {
            cur: function(oldValue , newValue){
                console.log(arguments);
            }
        },
        methods:{
            logout:function () {
                $.ajax({
                    type:"POST",
                    url:"../admin/logout.action",
                    data:{},
                    dataType:"json",
                    success:function (result) {
                        if (result.response === 0) {
                            location.href = "login.html";
                        }
                    },
                    error:function (request,status,error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            isLogin:function(){
                $.ajax({
                    url: "../admin/isLogin.action",
                    type: "POST",
                    data: {},
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 1) {
                            location.href="login.html";
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            toReportPage: function(type){
                location.href = "reportAdmin.html?type=" +type;
            },
            getSchool: function(){
                $.ajax({
                    url: "../admin/getSchools.action",
                    type: "POST",
                    data: {
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            identifySchool.schoolInfoList=result.schoolInfos;
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            disPlaySchool: function(){
                identifySchool.schoolPage=true;
                identifySchool.collegePage=false;
                identifySchool.majorPage=false;
                identifySchool.studentPage=false;
            },
            disPlayCollege: function(schoolID){
                $.ajax({
                    url: "../admin/getColleges.action",
                    type: "POST",
                    data: {
                        schoolID:schoolID
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            identifySchool.schoolPage=false;
                            identifySchool.collegePage=true;
                            identifySchool.majorPage=false;
                            identifySchool.studentPage=false;
                            identifySchool.collegeInfoList=result.collegeInfos;
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            disPlayMajor: function(collegeID){
                $.ajax({
                    url: "../admin/getMajor.action",
                    type: "POST",
                    data: {
                        collegeID:collegeID
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            identifySchool.schoolPage=false;
                            identifySchool.collegePage=false;
                            identifySchool.majorPage=true;
                            identifySchool.studentPage=false;
                            identifySchool.majorInfoList=result.majorInfos;
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            disPlayStudent: function(majorID){
                $.ajax({
                    url: "../admin/getStudent.action",
                    type: "POST",
                    data: {
                        majorID:majorID
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            identifySchool.schoolPage=false;
                            identifySchool.collegePage=false;
                            identifySchool.majorPage=false;
                            identifySchool.studentPage=true;
                            identifySchool.studentInfoList=result.studentInfos;
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            uploadSchool: function(schoolName,studentsInfo){
                $.ajax({
                    url: "../admin/saveSchool.action",
                    type: "POST",
                    data: {
                        schoolName:schoolName
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            identifySchool.uploadStudentsInfo(studentsInfo,result.schoolID,schoolName);
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            uploadStudentsInfo: function(studentsInfo,schoolID,schoolName){
                $.ajax({
                    url: "../admin/saveStudents.action",
                    type: "POST",
                    data: {
                        studentsInfo:studentsInfo,
                        schoolID:schoolID
                    },
                    dataType: "json",
                    success: function (result) {
                        if (result.resultCode === 0) {
                            alert("录入成功");
                            let obj = new Object();
                            obj.schoolID = schoolID;
                            obj.schoolName = schoolName;
                            obj.collegeNums = result.collegeInfo.length;
                            obj.majorNums = result.majorInfo.length;
                            identifySchool.schoolInfoList.push(obj);
                            console.log(identifySchool.schoolInfoList[0]);
                        }
                        if (result.resultCode === 1) {
                            alert("录入成功");
                        }
                        if (result.resultCode === 1) {
                            alert("xlsx文件格式有误");
                        }
                    },
                    error: function (request, status, error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            upload: function(){
                this.uploadSchool(identifySchool.schoolName,identifySchool.studentsInfo);
            },
            getReportType: function(reportType){
                $.ajax({
                    type:"POST",
                    url:"../admin/reportType.action",
                    data:{
                        reportType:reportType,
                    },
                    dataType:"json",
                    success:function (result) {
                        if (result.resultCode === 0) {
                            if(reportType===0)
                                identifySchool.questionReport=result.reportInfoList.length;
                            if(reportType===1)
                                identifySchool.answerReport=result.reportInfoList.length;
                            if(reportType===2)
                                identifySchool.commentReport=result.reportInfoList.length;
                            if(reportType===3)
                                identifySchool.replyReport=result.reportInfoList.length;
                        }
                    },
                    error:function (request,status,error) {
                        alert("系统异常！");
                        console.log(request.status);
                        console.log(request.readyState);
                        console.log(status);
                    }
                });
            },
            page: function(){
                identifySchool.all = Math.ceil(identifySchool.schoolInfoList.length/15) || 1;
                console.log(identifySchool.all);
            },
            btnClick: function(data){
                if(data != this.cur){
                    this.cur = data;
                    // reportAdmin.reportInfoList = reportAdmin.pageInfoList[this.cur-1];
                }
            },
            pageClick: function(){
                console.log('现在在'+this.cur+'页');
                // reportAdmin.reportInfoList = reportAdmin.pageInfoList[this.cur-1];
            },
            back: function () {
                if(this.collegePage)
                {
                    this.schoolPage=true;
                    this.collegePage=false;
                    this.majorPage=false;
                    this.studentPage=false;
                }
                if(this.majorPage)
                {
                    this.schoolPage=false;
                    this.collegePage=true;
                    this.majorPage=false;
                    this.studentPage=false;
                }
                if(this.studentPage)
                {
                    this.schoolPage=false;
                    this.collegePage=false;
                    this.majorPage=true;
                    this.studentPage=false;
                }
            }
        },
        computed: {
            indexs: function(){
                var left = 1;
                var right = this.all;
                var ar = [];
                if(this.all>= 5){
                    //这里最大范围从3到6，如果到达7，那么下边加2变成9，已经超过最大的范围值
                    if(this.cur > 3 && this.cur < this.all-1){
                        //以4为参考基准，左面加2右边加2
                        left = this.cur - 2
                        right = this.cur + 2
                    }else{
                        if(this.cur<=3){
                            left = 1
                            right = 5
                        }else{
                            right = this.all
                            left = this.all -4
                        }
                    }
                }
                while (left <= right){
                    ar.push(left)
                    left ++
                }
                console.log(ar);
                return ar
            },
            subArr() {
                if(this.schoolPage)
                    return this.schoolInfoList.slice((this.cur-1)*15,this.cur*15);
                if(this.collegePage)
                    return this.collegeInfoList.slice((this.cur-1)*15,this.cur*15);
                if(this.majorPage)
                    return this.majorInfoList.slice((this.cur-1)*15,this.cur*15);
                if(this.studentPage)
                    return this.studentInfoList.slice((this.cur-1)*15,this.cur*15);
            }
        },
        mounted:function () {
            // this.isLogin();
            this.getReportType(0);
            this.getReportType(1);
            this.getReportType(2);
            this.getReportType(3);
            this.getSchool();
        }
    });
    (function () {
        'use strict'
        feather.replace()
        // Graphs
        var ctx = document.getElementById('myChart')
        // eslint-disable-next-line no-unused-vars
    }())
</script>
</body>
</html>
