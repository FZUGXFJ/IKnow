<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>举报</title>
    <link rel="stylesheet" type="text/css" href="../css/global.css">
    <link rel="stylesheet" type="text/css" href="../css/computer.css">
    <link rel="stylesheet" type="text/css" href="../css/computer/user/login.css">
    <link rel="stylesheet" type="text/css" href="../css/computer/admin/acuse.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="https://lib.baomitu.com/font-awesome/5.11.2/css/all.min.css">
    <script type="text/javascript" src="https://lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://lib.baomitu.com/vue/2.6.10/vue.min.js"></script>
    <script type="text/javascript" src="../js/computer.js"></script>
</head>
<body style="background-color: aliceblue">
<nav class="navbar navbar-expand-lg navbar-light fix">
    <a class="navbar-brand" href="#" style="margin-left: 250PX"><img src="../img/LOGO透明%20(1).png"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active" style="margin-left: 10px">
                <a class="nav-link" href="#">首页 <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">问答</a>
            </li>
            <li class="nav-item">
                <div class="dropdown">
                    <a id="dLabel" data-target="#" href="#" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <img id="head" src="../img/头像.jpg">    <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="dLabel">
                        <li><a class="set" href="#">个人中心</a></li>
                        <li><a class="set" href="#">切换账户</a></li>
                        <li><a class="set" href="#">退出登录</a></li>
                    </ul>
                </div>
            </li>
        </ul>
        <script>
            $('.dropdown-toggle').dropdown()
        </script>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="高数" aria-label="Search">
            <button class="btn" type="submit" style="background-color: aqua;color: white">搜索</button>
        </form>
        <ul class="navbar-nav mr-auto ">
            <li class="nav-item dropdown" style="margin-left: 10PX">
                <select class="form-control form-control-lg">
                    <option>按题目查找</option>
                    <option>按回答查找</option>
                </select>
            </li>
        </ul>
    </div>

</nav>

<hr/>
<div id="contain">
    <div class="con1">
        <div class="accuseInfo row">
            <div class="col-md-2">举报id</div>
            <div class="col-md-2">用户id</div>
            <div class="col-md-2">举报类别</div>
            <div class="col-md-2">被举报id</div>
            <div class="col-md-2">举报时间</div>
            <div class="col-md-2"><button class="deal">处理</button></div>
        </div>
        <div class="accuseInfo row">
            <div class="col-md-2">举报id</div>
            <div class="col-md-2">用户id</div>
            <div class="col-md-2">举报类别</div>
            <div class="col-md-2">被举报id</div>
            <div class="col-md-2">举报时间</div>
            <div class="col-md-2"><button class="deal">处理</button></div>
        </div>
        <div class="accuseInfo row">
            <div class="col-md-2">举报id</div>
            <div class="col-md-2">用户id</div>
            <div class="col-md-2">举报类别</div>
            <div class="col-md-2">被举报id</div>
            <div class="col-md-2">举报时间</div>
            <div class="col-md-2"><button class="deal">处理</button></div>
        </div>
    </div>
    <!--<div class="con2">
        <div class="pageDiv page">
            &lt;!&ndash;=======&ndash;&gt;
            &lt;!&ndash;&gt;>>>>>> origin/dev&ndash;&gt;
            <nav aria-label="Page navigation example" id="page" style="float: left;margin-top: 1%">
                <ul class="pagination">
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>-->
</div>

<script type="text/javascript">
    let login=new Vue({
        el:"#login",
        data:{
            useEmail:true,
            isRmb:false,
            timeout:60,
            verify:false,
            emailError:false,
            emailErrorMsg:"",
            emailError1:false,
            emailErrorMsg1:"",
            passwordError:false,
            passwordErrorMsg:"",
            verifyCodeError:false,
            verifyCodeErrorMsg:"",
            alertMsg:{head:"",body:""},
        },
        methods:{
            validateVerify:function () {
                let verifyCode = $("#verifyCode");
                let val = verifyCode.val();
                val.length > 6 ? verifyCode.val(val.slice(0,6)) : "";
            },
            loginByEmail:function (email,verifyCode) {
                let al = $("#alert");
                $.ajax({
                    url:"../user/emailLogin.action",
                    type:"POST",
                    data:{
                        email:email,
                        verifyCode:verifyCode
                    },
                    dataType:"json",
                    success:function (result) {
                        if (result.response === 0) {
                            accusation.alertMsg.head = "登录成功";
                            accusation.alertMsg.body = "";
                            al.removeClass("alert-success");
                            al.removeClass("alert-danger");
                            al.addClass("alert-success");
                            al.slideDown();
                        } else if (result.response === 1) {
                            accusation.alertMsg.head = "登录失败";
                            accusation.alertMsg.body = "邮箱已修改，请重新发送验证码";
                            al.removeClass("alert-success");
                            al.removeClass("alert-danger");
                            al.addClass("alert-danger");
                            al.slideDown();
                        } else if (result.response === 2) {
                            accusation.alertMsg.head = "登录失败";
                            accusation.alertMsg.body = "验证码错误";
                            al.removeClass("alert-success");
                            al.removeClass("alert-danger");
                            al.addClass("alert-danger");
                            al.slideDown();
                        } else if (result.response === 3) {
                            accusation.alertMsg.head = "登录失败";
                            accusation.alertMsg.body = "该邮箱未注册";
                            al.removeClass("alert-success");
                            al.removeClass("alert-danger");
                            al.addClass("alert-danger");
                            al.slideDown();
                        }
                    },
                    error:function (e) {
                        alert("服务器异常");
                    }
                });
            },
            loginByPassword:function (email,password) {
                $.ajax({
                    url:"../user/passwordLogin.action",
                    type:"POST",
                    data:{
                        email:email,
                        password:password
                    },
                    dataType:"json",
                    success:function (result) {
                        if (result.response === 0) {
                            accusation.alertMsg.head = "登录成功";
                            accusation.alertMsg.body = "登录成功";
                            $("#alert").slideDown();
                        } else if (result.response === 1) {
                            accusation.alertMsg.head = "登录失败";
                            accusation.alertMsg.body = "邮箱或密码错误";
                            $("#alert").slideDown();
                        }
                    },
                    error:function (e) {
                        alert("服务器异常");
                    }
                });
            },
            getVerifyCode:function () {
                let email = $("#email");
                let emailRegex = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
                if (!emailRegex.test(email.val())) {
                    this.emailError = true;
                    this.emailErrorMsg = "邮箱格式错误，请重新输入";
                    return;
                } else {
                    this.emailError = false;
                }
                email.attr("disabled",true);
                this.verify = true;
                let timer = setInterval(function () {
                    accusation.timeout--;
                    if (accusation.timeout === 0) {
                        clearInterval(timer);
                        accusation.verify = false;
                        accusation.timeout = 60;
                        email.attr("disabled",false);
                    }
                }, 1000);
                $.ajax({
                    url:"../user/sendEmail.action",
                    type:"POST",
                    data:{
                        email:email.val(),
                    },
                    dataType:"json",
                    success:function (result) {
                        accusation.alertMsg = result;
                        $("#alert").slideDown();
                    },
                    error:function (e) {
                        alert("邮件发送失败");
                    }
                });
            },
            closeAlert:function () {
                $("#alert").slideUp();
            },
            validator:function () {
                let email = $("#email").val();
                let email1 = $("#email1").val();
                let password = $("#password").val();
                let verifyCode = $("#verifyCode").val();
                let emailRegex = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
                if (this.useEmail) {
                    if (!emailRegex.test(email)) {
                        this.emailError = true;
                        this.emailErrorMsg = "邮箱格式错误，请重新输入";
                    } else {
                        this.emailError = false;
                    }
                    if (verifyCode.length === 0) {
                        this.verifyCodeError = true;
                        this.verifyCodeErrorMsg = "验证码为空";
                    } else {
                        this.verifyCodeError = false;
                    }
                    if (!this.emailError && !this.verifyCodeError) {
                        this.loginByEmail(email,verifyCode);
                    }
                } else {
                    if (!emailRegex.test(email1) && !this.useEmail) {
                        this.emailError1 = true;
                        this.emailErrorMsg1 = "邮箱格式错误，请重新输入";
                    }else {
                        this.emailError1 = false;
                    }
                    if (password.length === 0) {
                        this.passwordError = true;
                        this.passwordErrorMsg = "密码为空"
                    } else {
                        this.passwordError = false;
                    }
                    if (!this.emailError && !this.passwordError) {
                        this.loginByPassword(email1,password);
                    }
                }
            },
            back:function () {
                window.history.back();
            }
        },
    });
</script>

</body>
</html>